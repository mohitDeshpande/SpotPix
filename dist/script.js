function traverse(e){if(e.hasChildNodes()){document.write("<ul><li>"),document.write("<b>"+e.tagName+" : </b>");for(var o=e.childNodes.length,t=0;t<o;t++)traverse(e.childNodes[t]);document.write("</li></ul>")}else document.write(e.nodeValue)}function showImages(e,o){var t={async:!0,crossDomain:!0,url:"https://api.flickr.com/services/rest",method:"GET",data:{method:"flickr.photos.search",api_key:"dac6357d0d6e3999018a556618331d5d",lat:e,lon:o,format:"json",nojsoncallback:1},dataType:"json",error:flickrApiCallFail,success:function(e){$.each(e.photos.photo,function(e,o){var t=o.farm;console.log(JSON.stringify(o));var n=o.server,a=o.id,r=o.secret;$("#gallery").append('<img src="https://farm'+t+".staticflickr.com/"+n+"/"+a+"_"+r+'.jpg"/>')})}};$.ajax(t)}function flickrApiCallFail(e,o,t){console.error("Flickr call failed.\nError:"+t+"\nStatus:"+o)}function initMap(){map=new google.maps.Map(document.getElementById("map"),{center:toronto,zoom:12,mapTypeId:"roadmap"}),createMapSearch(map),showImages(43.6426,-79.3871)}function createMapSearch(e){var o=document.getElementById("map-search"),t=new google.maps.places.SearchBox(o);e.controls[google.maps.ControlPosition.TOP].push(o),e.addListener("bounds_changed",function(){t.setBounds(e.getBounds())});var n=[];t.addListener("places_changed",function(){var o=t.getPlaces();if(0!=o.length){n.forEach(function(e){e.setMap(null)}),n=[];var a=new google.maps.LatLngBounds;o.forEach(function(o){if(!o.geometry)return void console.log("Returned place contains no geometry");var t={url:o.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)};n.push(new google.maps.Marker({map:e,icon:t,title:o.name,position:o.geometry.location})),o.geometry.viewport?a.union(o.geometry.viewport):a.extend(o.geometry.location)}),e.fitBounds(a)}})}var xmlhttp=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");xmlhttp.open("get","data/locations.xml",!1),xmlhttp.send(null);var xmlDoc=xmlhttp.responseXML,locate=xmlDoc.documentElement;traverse(locate),map=null;var toronto={lat:43.6426,lng:-79.3871};$("section").height($(window).height()),$("#find-btn").click(function(){$("body").animate({scrollTop:$("#map").offset().top},1200)});