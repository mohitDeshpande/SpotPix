function traverse(e){if(e.hasChildNodes()){document.write("<ul><li>"),document.write("<b>"+e.tagName+" : </b>");for(var o=e.childNodes.length,t=0;t<o;t++)traverse(e.childNodes[t]);document.write("</li></ul>")}else document.write(e.nodeValue)}function initMap(){map=new google.maps.Map(document.getElementById("map"),{center:toronto,zoom:12,mapTypeId:"roadmap"}),plotMarkers(map),createMapSearch(map)}function createMapSearch(e){var o=document.getElementById("map-search"),t=new google.maps.places.SearchBox(o);e.controls[google.maps.ControlPosition.TOP].push(o),e.addListener("bounds_changed",function(){t.setBounds(e.getBounds())});var a=[];t.addListener("places_changed",function(){var o=t.getPlaces();if(0!=o.length){a.forEach(function(e){e.setMap(null)}),a=[];var n=new google.maps.LatLngBounds;o.forEach(function(o){if(!o.geometry)return void console.log("Returned place contains no geometry");var t={url:o.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)};a.push(new google.maps.Marker({map:e,icon:t,title:o.name,position:o.geometry.location})),o.geometry.viewport?n.union(o.geometry.viewport):n.extend(o.geometry.location)}),e.fitBounds(n)}})}function plotMarkers(e){var o,t=new google.maps.Geocoder,a=new XMLHttpRequest;a.open("GET","/data/locations.xml",!1),a.send();for(var n=a.responseXML,r=n.getElementsByTagName("Location"),i=0;i<r.length;i++)for(var s=r[i],l=s.getElementsByTagName("PostalCode"),c=0;c<l.length;c++){var p=l[c].childNodes[0].nodeValue;t.geocode({address:p},function(t,a){if(a==google.maps.GeocoderStatus.OK){o=new google.maps.Marker({position:t[0].geometry.location,map:e});var n="<h1>"+s.LocationName+"</h1><p>"+s.address+"</p>",r=new google.maps.InfoWindow({content:n});o.addListener("click",function(){r.open(e,o)})}})}}var xmlhttp=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");xmlhttp.open("get","data/locations.xml",!1),xmlhttp.send(null);var xmlDoc=xmlhttp.responseXML,locate=xmlDoc.documentElement;traverse(locate),$(document).ready(function(){var e=$("#allImages").val();$.getJSON("https://api.flickr.com/services/rest/?method=flickr.people.getPublicPhotos&api_key=68f9a3498ff770330ef51429836ba68a&user_id=66956608%40N06&format=rest&auth_token=72157678860534383-321835e8bafb0244&api_sig=8f0ca3e941f6fd4f64759402fa3447df",{tags:e,per_page:50,format:"json"},function(e){$.each(e.photos.photo,function(e,o){var t="https://farm"+o.farm+".staticflickr.com/"+o.server+"/"+o.id+"_"+o.secret+".jpg";$("#singleImage").append('<img src="'+t+'"/>')})})});var API="AIzaSyCgMElgfY8buDapA2d3VO-7fWgMJCPqhqk";map=null;var toronto={lat:43.6426,lng:-79.3871};$("section").height($(window).height()),$("#find-btn").click(function(){$("body").animate({scrollTop:$("#map").offset().top},1200)});